# クラス名とCSS設計

CSSで正しくデザインを表現できたとしても、
1つのデザインを表現するためのCSSの書き方は様々なものがあります。

複数人で作業を進める上では、わかりやすく、管理しやすいCSSの記述が必要不可欠です。

ここではCSS設計を通じて、読みやすい・保守性の高いCSSの書き方について考えていきます。
 
## SMACSS - CSSのレイヤを考える

デザインを1つのCSSに落とし込む上で、 CSSの構造について整理し理解するアプローチはとても重要です。

Webサイト全体を要素ごとに漠然とスタイリングすると、
不要な重複するコードが生まれたり、同じ意味合いのコードが複数箇所に分散したりと、
冗長で読みにくく、メンテナンスし辛いコードが出来上がってしまいます。

一口にCSSといってもその役割は様々で、構造に分けて捉える必要があります。
CSSの構造に関する便利な考え方として、SMACSSが提供する5つのカテゴリーが利用できます。

- `ベース`	要素そのもののデフォルトスタイル
- `レイアウト`	ページをエリアごとに分割するためのスタイル
- `モジュール`  再利用可能なパーツごとのスタイル
- `状態（ステート）`	レイアウトやモジュールの特定の状態を表現するスタイル
- `テーマ`	サイトのルック＆フィールを提供するスタイル

SMACSS(スマックス） はScalable and Modular Architecture for CSSの略で、
「CSSをより体系立て、より構造化させることで制作とメンテナンスをより容易に行うテクニック」として
広く認知されているCSS設計の考え方です。

[https://smacss.com/](https://smacss.com/)

SMACSSの概念に基づいてCSSを分割することで、
それぞれのCSSで定義すべき内容や役割が見えてくるはずです。

### ベース

サイト全体で利用されるHTML要素そのもののデフォルトのスタイルです。

Normalize.cssなどのリセットCSSと呼ばれるものもここに位置します。

ブラウザデフォルトの状態に依存するよりも、何らかのリセットCSS導入しておくことで、
ブラウザごとの差異をなくしたり、コーディング上の指針を共通化することができるようになります。

### レイアウト

サイト全体で適用されるようなグリッドやカラムなどの大きなレイアウトの定義は、
詳細のCSSと分けて記述します。

個々のCSS定義がレイアウトに依存する形で記述されてしまうと、レイアウトの変更に応じて、
個別のCSSを書き直すことになりかねません。

保守性を考える上でも、レイアウトに関するルールは個別のCSSから極力分離しておくほうが良いでしょう。

### モジュール

再利用可能なページ上で繰り返し利用されるUIを定義します。

画面上で表示するボタンやアラートなどの項目は、ページ全体での表示方式を共通化するために、
同じクラス等を用いて表示を統一化するほうが良いでしょう。

### ステート 

ページ上で変化しうる状態を表現するCSSのクラスです。

トグルボタンや、ナビゲーションの選択状態など、ユーザの入力に応じて活性非活性が変化する `.is-active` や
バリデーションメッセージや、アラートなど、特定の条件を満たさない限り非表示とする `.is-hidden` などがこれに当たります。

### テーマ

サイト内で利用する色やフォントなどの見た目・雰囲気を構成する要素をテーマとして分割して管理します。

テーマを差し替えることにより、サイト全体の雰囲気を微調整する事が可能になり、
CSSの再利用性・柔軟性が向上します。

### その他のCSS 

SMACSSによるカテゴリ分けの関心は、「デザインの中で繰り返されるパターンを体系立てる」ことに関心が置かれています。

実際のCSSを記述する上では、ここに要素単位の個別のレイアウトなど、再利用性のない個々のスタイリングが必要になるでしょう。

特に、要素が固有で持つべきマージンや高さ・幅等の要素を、
モジュールやテーマとして再利用可能な状態に置いてしまうと、
CSSの再利用性が低下し、コーディングの柔軟性が損なわれます。

「何を共通化すべきで、何を共通化すべきでないか」をしっかり検討し、
デザイナー・顧客合わせて認識を統一することが、CSSの管理コスト低減に大きく貢献します。

## CSSにおけるクラス命名の関心
 
CSSではHTML上のようそにクラス名をつけて、クラス名の単位でデザインを適用します。

クラス名の管理はコード管理の上でとても重要であり、クラスの命名についての考え方が統一されていることは、
コード管理上とても重要なことです。

クラスの命名に関する考え方がバラバラだと、
不要なコードの重複が生まれたり、意図しないクラス名の再利用が行われり、といった問題が発生するでしょう。
 
クラスの命名を考える上で問題となる大きなテーマとして以下のようなものが挙げられます。

- クラス名はどのようなケースで再利用されるべきか、または再利用されるべきではないか
- 単一のHTML要素はただ1つのクラスメイを持つべきか、複数のクラス名付を許容するか
- クラス名は見た目を表す名前として命名されるか、セマンティックに命名されるか

こういったコーディング上の考え方の違いが1つのサイト内で統一されていないと、
サイト全体でのクラス名の考え方に大きなブレが生じ、コーディング上の支障をもたらしてくるでしょう。
 
まずは、要素の何に対してクラス名をつけるか、という点について考えてみましょう。

### デザインに対してつける

要素に適用されるデザインに対して名前をつける方法

お問い合わせの赤いボタンの場合 `red` `bordered` などのクラス名がつく。

### UIに対してつける

要素がユーザに対して提供するページ上の機能に対して名前をつける方法

お問い合わせの赤いボタンの場合 `btn` などのクラス名がつく。

### アウトラインに対してつける

要素のページ上での意味合いに対して名前をつける方法 

お問い合わせの赤いボタンの場合 `contact-action` などのクラス名がつく。

## 様々なCSS設計 
 
### デザインに対して名前をつける考え方
 
`red` や `mt20` などCSSに直結するクラスを作成して、組み合わせて使う方法です。
 
わかりやすく、利用しやすい一方で共通のCSS部分のメンテナンスが難しく、
HTML要素に付与されるクラスも多くなりがちと言った問題があります。
 
運用上の理由で、例えば `red` に `font-weight` が設定されてしまったり、
多様な赤を表現するために、`red` の他に `red2` `red3` などのクラスが生まれるなどの事故も起こりやすく、
管理がとても複雑になる、といった問題もあります。

また、デザインとHTMLコードは強固に結びついているため、
デザインの変更に対して、HTMLの修正も頻繁に起こりやすくなる傾向があります。

CSSを記述するような感覚でクラス名を付与してHTMLのコーディングができるため、
感覚的には利用しやすく便利ですが、 CSSは必要に応じて都度継ぎ足され、また既存のCSS定義の修正もしずらく
複雑になりがちなため、大きなプロジェクトでは利用を避けるほうが良いでしょう。
 
### UIに対して名前をつける考え方
 
`btn` や `alerts` などページ上のUI要素単位に名前をつけて管理する方法です。

サイト内で利用されているUI間で見た目が常に同じとなることが保証されるため、
コンポーネントベースでのデザインを表現する上でとても便利です。
 
逆にコンポーネントを意識しないデザインに置いて、
同じUIが、細部異なる見た目を持っている…といったケースでは対応が困難になってきます。

コンポーネントの設計を行っていたとしても、
同じボタン群で、色や大きさのバリエーションなどの違いがあるケースもあるため、
バリエーションの管理には工夫が必要です。

またレイアウト上の位置によって、同じUIでも異なるマージンを持つケースも考えられます。
このようなレイアウト上の設計をどれだけ緻密に行い、顧客と共有できるかがコンポーネント設計の鍵となってくるでしょう。

デザインとHTMLコードの結びつきは比較的緩やかになっているため、
デザインの変更があっても、単純なUI上の見た目の変化はCSSのみの修正で実装できるでしょう。

一般的なCSSフレームワークなどはこの思想をベースにCSSが記述されています。
 
### OOCSSの考え方
 
OOCSS(Object Oriented CSS)は、CSS上でUIを表現する上での、クラス設計の考え方です。
 
OOCSSでは、UIを構成する要素を、構造と見た目に分けて2つのクラスで見た目を管理します。

[http://oocss.org/](http://oocss.org/)
 
<p data-height="265" data-theme-id="0" data-slug-hash="aPjQZR" data-default-tab="css,result" data-user="mikakane" data-pen-title="aPjQZR" class="codepen">See the Pen <a href="https://codepen.io/mikakane/pen/aPjQZR/">aPjQZR</a> by mikakane (<a href="https://codepen.io/mikakane">@mikakane</a>) on <a href="https://codepen.io">CodePen</a>.</p>

例では、 `btn` クラスは、 ボタン要素の構造を、
`btn-red` `btn-blue` 要素はボタン要素の見た目を提供しています。 

このようにUI要素の構造と見た目を分けて管理することで、1つのCSS群から、
複数のバリエーションを表現する事が可能になります。

この考え方はSCSSにおけるmixinの設計でも非常に重要なものとなりますので、
概念としてはしっかり理解しておくほうが良いでしょう。

### アウトラインに対して名前をつける考え方

アウトラインとはページドキュメントの構成を指すものです。
 
アウトラインに対して名前をつける場合、
HTML上のクラスはそれぞれの文脈に応じて（たとえ同じ見た目であっても！）個別のクラス名が付与されるため、
クラス名の再利用はほとんどされなくなります。

「何が共通化されるべきで、何を共通化すべきでないか」の検討は、ときに非常に困難であるケースもあるため、
アウトラインベースでシンプルにクラスの命名を行う場合、
デザインの独立/再利用からなる複雑さはHTML上から取り除かれます。

この場合、理論上はデザインをほとんど意識することなくHTMLコードを記述する事が可能となり、
情報・コンテンツに変更がない限り、デザインの変更に伴うHTMLコードの修正も不要になります。

一方で、CSSの容量は大きくなりがちなため、SCSSの `@extend` を利用した工夫などが必要になるケースもあるでしょう。
見た目が同じでも異なるクラス名が利用されるため、サイト全体で統一した色やサイズを利用したい場合に
SCSSの変数等を利用した管理も不可欠になってきます。

アウトラインベースで名前をつける考え方の設計としてはECSSの考え方が参考になります。

[http://ecss.io/](http://ecss.io/)
 
### BEM  
 
これまでの議論とはこの異なり、BEMはクラスの命名ルールに関する考え方を提供してくれるものです。

BEMはBlock-Element-Modifierの略語で、CSSの命名を以下の形で考えます。
 
- 命名に関する要素を `Block` `Element` `Modifier`の3つで考える。
- `Block` は要素の大きなグループを表す。
- `Element` は `Block` 内の小要素を表す。
- `Modifier` は `Block` `Element` の状態を表現する。
- クラス名における `Block` `Element` `Modifier` はそれぞれ適切な記号を用いて区切って表現される
- `Element` は単独で用いられる、 必ず `Block` とセットで表現される。

![](/images/sec3/github_captions.jpg)

[image from getbem.com](http://getbem.com/introduction/)
 
通常、 `BEM` では `block__element--modifier` の様に `__` `--` などの記号2つ分の区切り文字を用いて表現されるケースが多いようです。

### FLOCSSの考え方
 
FLOCSSはさまざまなCSSプロジェクトの中で、ECSSやUIベースのCSSなどを柔軟に実現するための
プロジェクト管理の手法です。
 
[https://github.com/hiloki/flocss](https://github.com/hiloki/flocss)

FLOCSSではCSSを以下のようなレイヤーに分けて記述します。
 
```text
- Foundation - reset/normalize/base...
- Layout - header/main/sidebar/footer...
- Object
    - Component - grid/button/form/media...
    - Project - articles/ranking/promo...
    - Utility - clearfix/display/margin...
```

`Foundation` や `Layout` はSMACSSにおけるベースやレイアウトのCSSを記述する箇所になります。

SMACSSで言うところの再利用可能なモジュールはComponentに、
その他のアウトラインアウトラインベースでのページ固有のCSSはProjectに格納されます。

Layoutについては `l-` の、
ComponentのCSSとProjectのCSSはそれぞれ `c-` `p-` の接頭辞を用いて命名され、
HTML上からも利用されるクラス名がどのようなレイヤーに位置するものかを簡単に理解することが可能です。

接頭辞以降のクラス名は原則BEMに沿って命名され、クラス間のBlock Elementのつながりもわかりやすくすることができます。

また、Utilityとして軽微なスタイルの調整などを記述する汎用CSSを定義することもでき、
コーディング上で必要に応じて `.mt10` などのヘルパークラスを定義する余地も用意されています。

## 詳細度の考え方

CSSを記述する上で、詳細度に関しても少し考慮する必要があります。

詳細度はCSSを適用する上での強さを表すセレクタの持つ数値です。
 
[https://developer.mozilla.org/ja/docs/Web/CSS/Specificity](https://developer.mozilla.org/ja/docs/Web/CSS/Specificity)
 
既存のCSS記述を別のCSS定義を用いて後から上書き変更しようとした場合、
元の詳細度よりも強い詳細度を用いる必要があります。

IDセレクタは、一般に非常に強い詳細度を持っているため、
クラス等で記述するCSSを用いてこれを上書きする事ができなくなってしまいます。

同様に `style` 属性を用いた直接のスタイル定義も、非常に強い詳細度を持つため、
他のCSSを用いてこれを上書き変更することができません。

クラスセレクタを利用したケースでも、子孫セレクタを用いた指定は、
継承を追うごとにどんどんと詳細度が高くなってしまいます。

<p data-height="265" data-theme-id="0" data-slug-hash="pqZBdY" data-default-tab="css,result" data-user="mikakane" data-pen-title="pqZBdY" class="codepen">See the Pen <a href="https://codepen.io/mikakane/pen/pqZBdY/">pqZBdY</a> by mikakane (<a href="https://codepen.io/mikakane">@mikakane</a>) on <a href="https://codepen.io">CodePen</a>.</p>

CSSセレクタにおける親子セレクタの深さ定義は、全体で上限を設ける方が良いでしょう。
