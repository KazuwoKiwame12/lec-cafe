# レスポンシブデザインと単位

異なるデバイス上でコンテンツのレイアウトを柔軟に変化させるデザインの手法をレスポンシブデザインといいます。

スマートフォンが完全に普及し、インターネットの閲覧デバイスとしての地位を確かにした今、
Webサイトを多様なデバイスに対応させることのニーズは非常に高くなっています。

一言にレスポンシブと言っても、考慮すべきポイントは様々です。
マルチデバイス対応の肝となるレスポンシブの考え方とテクニックを確認していきましょう。

## マルチデバイスのデザイン

PCの画面（以下PC) とスマートフォンなどの小さい画面（以下SP) など異なるデバイス上でのデザインを考える上で、
単純な画面サイズの違い以外にも様々な問題を考慮しなければなりません。

レスポンシブの手法を考える前に、
マルチデバイスでのデザインを考慮する上で重要な点を考えてみましょう。

### スマートフォンの画面サイズへの適合

マルチデバイスを考える上で画面サイズの違いは大きな問題です。

一般的に、スマートフォンは、PCよりも小さな画面サイズとなっており、
PCで横並びに表示していたコンテンツが、 スマートフォンでは縦並びに調整しなければならない、
と言った問題は多々発生します。

デザインを考える上では、横のサイズだけでなく、縦のサイズも考慮しなければならないため、
単純にPCのコンテンツをSP向けに縦並びに調整するだけでは、
SPの画面コンテンツはダラダラと長い印象を持つようになるでしょう。

コンテンツの長さを適切な長さに納めるためには、
SPでの表示を考慮しながら画面の小さいサイズをベースにコンテンツ量の切り分けを考える必要があるでしょう。

### 大きな画面サイズへの適合

小さな画面サイズだけでなく大きな画面サイズへの適合も重要な問題です。

最近ではPCでも画面幅100％ でコンテンツを表示するWebサイトが増えてきていますが、
無限に幅100% でコンテンツを展開し続けるのは非常に困難です。

最近では4Kのディスプレイが登場したり、 Macでも3K程度の解像度で画面を出力することが可能になってきているため、
FullHD相当のブラウザではきれいに表示できていても、大きな解像度のモニタで全画面表示するとサイトデザインが崩れる…といったケースも出てくるかもしれません。

増え続ける解像度に無限に対応するのは困難ですので、適切なコンテナでコンテンツの表示領域を制限し、
幅100％ で展開するのは、背景色やボーダーなどのデザイン要素のみに絞る方が良いでしょう。

### 異なるUIへの対応

複数の画面サイズに対応する上で、異なるデバイスのUI上の都合も考慮する必要があるでしょう。

スマートフォンやタブレットなどのタッチデバイスは、
Webブラウザ上のホバーの機能が乏しく、
またドラッグを用いたつかみの操作や、水平方向のフリックがやりづらいという課題があります。

クリック領域についてもSPにおけるデザインの場合は押しやすさが重要です。
ポインタで操作するPCと違って、
タッチデバイスでは指のサイズを考慮した大きなボタンでクリック可能コンテンツを表現しなければなりません。

逆に傾き検出やカメラアップロードなどスマートフォン等固有のUIもありますので、
デバイスごとにUIが異なることを念頭に置きながら、適材適所のUIを構築する必要があります。

### 異なる利用場面への対応

デバイスが異なればWebサイト閲覧のシーンも変わってきます。

PCでWebサイトを閲覧するケースに比べて、
SPでWebサイトを閲覧するケースでは、ユーザの集中力が低い、という事は比較的ありえるでしょう。
サイトの流入経路に関しても、ソーシャル関係のシェア流入は比較的スマートフォンなどモバイル端末からの方が多い化もしれません。

逆にPCでのWebサイト閲覧状況を考慮した場合、
求めてい情報を獲得するための高度なUI 
協力な入力UIを利用した操作系が求められていたり、入力などの操作がやりやすい

## レスポンシブデザイン

以上の考慮を踏まえて、マルチデバイスに柔軟に対応するためのデザインの手法をレスポンシブデザインと言います。

一般的にレスポンシブデザインでは、 
画面幅に対して柔軟にレイアウトを変化させることで、
マルチデバイス上でのレイアウト変更を実現しています。

このようなレイアウト変更をするための仕組みとして、
画面幅に応じて異なるCSSプロパティを適用させる
メディアクエリと呼ばれる仕組みが用意されています。

マルチデバイスをサポートしているとしても、
PCとSPで別々のURLが用意されていたり、
ブラウザのUser Agent (UA) を判別して異なるHTMLをサーバから返信するといったような手法は、
レスポンシブデザインとは違ったアプローチとなります。

### モバイルファーストの考え方

モバイルファーストとは、「モバイル向けの画面を最重視する」という意味合いの考え方です。

前述の通り、コンテンツの表示量を考えた際にPC優先で考え始めると、
どうしてもモバイル側にレイアウトを変換した際に、表示量が溢れてメリハリのないサイト構成になってしまいがちです。

「モバイルでの見え方」さらには「モバイルでのユーザ体験」を重視してデザインを考えることで、
レスポンシブ対応に関するコストは大きく削減できる筈です。

### ブレークポイント

マルチデバイスを考える上で、レイアウトの分岐点となるポイントをブレークポイントといいます。

デザインの中で要素ごとにブレークポイントを考えるのは、コーディング管理が非常に煩雑になるため、
サイト全体でブレイクポイントの種類を予め決めておく方が良いでしょう。

一般的にサイトで1つのブレークポイントを設定する際には、
スマートフォンとタブレットの一般的な分岐点である `768px`  がブレークポイントとして用いられることが多いようです。

この場合、SP向けの `320-768px` の画面幅では、画面幅に比例した `%` ベースのコーディングを行います。
コンテナサイズも `width: 100%` として画面サイズに応じて柔軟に変化するコンテナを採用します。

`768px` 以上の画面では `768px` のコンテナサイズでコンテンツ表示幅を制限してサイトをデザインします。

`768px` のコンテナが小さすぎる場合、2つめ、3つめのコンテナサイズを設定してブレークポイントに追加すると良いでしょう。

![](/images/sec2/File.jpg)

> image from [http://responsive-jp.com](http://responsive-jp.com)

### レスポンシブしない選択肢

全てのWebデザインやUIがレスポンシブと相性が良いというわけではありません。

例えばGmailやGitHubなどでは、PCとSPで全く異なるデザインを適用しています。
PC向けサイトのコンテンツ量が多い場合や、 UIが複雑な場合などは、
あえてレスポンシブデザインを適用せずに、別々のサイトを用意するケースも考えられます。

また最近ちらほら目にするようになりましたが、
スマホからの利用がほとんどのWebサイトに置いては、
横640px程度のWebサイトのみ作成して、PC向けの最適化を行わないという選択肢も考えられます。

ユーザからの確実なシェアを狙いたい場合など確実にモバイル端末でアクセスしてほしい場合には、
PC向けのサイトではコンテンツを何も表示せず、 SP閲覧用のQRコードのみ表示する、といったケースも考えられます。

## メディアクエリの書き方

CSSでレスポンシブデザインを実現するには、
メディアクエリを利用して画面幅ごとに異なるCSSを記述する方法が一般的です。

PCをベースにしたメディアクエリの書き方は以下のようになります。

```css
p { font-size: 16px; }
 
@media screen and (max-width:768px) { 
	p { font-size: 14px; }
}
 
@media screen and (max-width:480px) { 
	p { font-size: 12px; }
}
```

PCをベースにするためPC向けのCSSを記述した上で、
メディアクエリ内で、 SP向けのCSS定義を記述していきます。

指定したサイズ以下の画面幅に対してメディアクエリの内容を適用するため、`max-width` の条件式を利用しています。

逆にSPをベースにする場合、以下のようなCSSが出来上がるでしょう。

```css
p { font-size: 12px; }
 
@media screen and (min-width:768px) { 
	p { font-size: 14px; }
}
 
@media screen and (min-width:1024px) { 
	p { font-size: 16px; }
}
```

こちらは、SPをベースにするためSP向けのCSSを記述した上で、
メディアクエリ内で、 PC向けのCSS定義を記述していきます。

指定したサイズ以上の画面幅に対してメディアクエリの内容を適用するため、`min-width` の条件式を利用しています。

メディアクエリが無くてもmax-widthやmin-widthの記述を利用して簡易的にレスポンシブデザインを実現することも可能です。

### スマートフォン向けのCSS

コンテナ幅 = 画面幅となるスマートフォン向けのCSSでは、
横幅を `%` を用いてコーディングするなどして、コンテナから要素が溢れないように注意する必要があります。

複数の画面幅で適切にコンテンツを表示できるよう注意が必要ですが、
iphone5やiPhone SE、古いAndroidなどをターゲットデバイスに含める場合は、
`320px` での表示確認を必ず行う必要があります。

テキストコンテンツなどは、画面幅のサイズに応じて折り返し量が大きく異なるため、
各画面幅での表示量の違いに十分注意する必要があります。

### PC向けのCSS 

コンテンツは基本、固定幅のコンテンツ内部に収めて、
画面幅の変化に影響されないレイアウトの構築が望ましいです。

コンテナから外れて、画面幅全体に対してデザインを適用する場合、
大画面にも対応するために4k等での表示確認を念の為行うのが良いでしょう（Chromeの検証ツール）

### メディアクエリのまとめ方

CSS全体でどのようなメディアクエリを記述するかの方針は予め決めておく必要があります。

通常のCSSとメディアクエリでのCSSを分離する書き方を採用する場合、
以下のようなCSSの書き方になります。

```css
.title { font-size: 12px; }
.body { font-size: 10px; }
 
@media screen and (min-width:768px) { 
	.title { font-size: 14px; }
    .body { font-size: 12px; }
} 
```

メディアクエリの記述が1回で済むため、ブレークポイントの管理は簡単になります。

PC版のコーディングを一旦完成させてから、
別の担当者がメディアクエリでSP版をコーディングしていく際などには便利な書き方かもしれませんが、
1つのコンポーネントに対して、CSSの記述が乱立するためサイト全体の管理としては都合が悪いケースもあるでしょう。

要素ごとにまとめてメディアクエリを記述する場合、以下のように複数回のメディアクエリの記述が発生します。

```css
.title { font-size: 12px; }
@media screen and (min-width:768px) { 
	.title { font-size: 14px; }
}

.body { font-size: 10px; }
@media screen and (min-width:768px) { 
    .body { font-size: 12px; }
}
```

要素ごとにCSSを探す場合こちらのCSS記述のほうが目的のCSSに到達しやすく改修の手間も少ないですが、
何回もメディアクエリを記述する手間や、様々な箇所で記述されているメディアクエリを管理するコストは大きくなります。

SCSSを利用する場合はmixinを利用して簡単にこれを記述することができます。

```scss
@mixin desktop() {
  @media (min-width: 768px) {
    @content;
  }
}
```

```scss
.title { 
  font-size: 12px; 
  @include desktop{
    font-size: 14px;  
  }
}
.body { 
  font-size: 10px; 
  @include desktop{
    font-size: 12px;  
  }
}
```

mixinを使うのが複雑な場合、 最低限 `768px` などのブレークポイントだけは変数化して共通化できるようにしておきましょう。

### Flexboxを利用してレスポンシブする

PC版では横並びに表示するコンテンツをSP版では縦に表示する、
と言ったよくあるレスポンシブのパターンは、
flexboxを使って簡単に表現する事ができます。

flexboxを利用したレスポンシブの場合、 メディアクエリで `flex-wrap` の値を調整するだけで
PC版では一列に横並び、 SP版では縦に並べる、といった表現が可能です。

<p data-height="265" data-theme-id="0" data-slug-hash="BvQqwZ" data-default-tab="css,result" data-user="mikakane" data-pen-title="BvQqwZ" class="codepen">See the Pen <a href="https://codepen.io/mikakane/pen/BvQqwZ/">BvQqwZ</a> by mikakane (<a href="https://codepen.io/mikakane">@mikakane</a>) on <a href="https://codepen.io">CodePen</a>.</p>

折り返しつつ（`flex-wrap: wrap`) 3列表示…といったPC向けデザインのケースでは、
`width` や `flex-basis` をメディアクエリで調整することができます。

## CSSにおける単位　

### `px`

`px` は画面のピクセルサイズで指定する最も一般的な単位です。

`1px` は実際の画面解像度における `1px` とは異なり、ブラウザ上での論理解像度の `1px` とは異なります。

画面解像度の `1px` とブラウザ上での `1px` の差のことをデバイスピクセル比（device pixel ratio) といい、
最近のモバイル端末では `2-4` 程度の値が取られているようです。

モバイル端末で画像がぼやけるといった問題は、このデバイスピクセル比に起因するもので、
ターゲット端末のデバイスピクセル比に対して適切なサイズの画像を用意しなければなりません。

### `%` 

`%` は　親要素に対する相対的な割合を指定する際に有効な単位です。

コンテナ幅 = 画面サイズのような、幅が変化するデザインにおいては、
幅の指定を `%` でコーディングするか、
`max-width` などの指定を行い、コンテナから要素が溢れてしまうことのないように注意しましょう。

### `em`

emは要素のフォントサイズ（文字の高さ）を `1em` とする単位です。

font-sizeで `em` を利用する場合、親要素（親要素がない場合はルート）のfont-sizeを1emとする値になります。
それ以外の値にemを使用した場合、 その要素のfont-sizeを1emとする値になります。 

文字サイズに合わせてデザインを行いたい場合に便利で、 
例えば1文字分の余白を左右に設けたい、といった場合では、以下のようなCSSを記述することができます。

```css
.text{
    padding: 0 1em;
}
```

### `rem`

`em` が現在の要素のフォントサイズに対する単位だったのに対し、
`rem` はルートのフォントサイズに対する単位として機能します。

ルートのフォントサイズは通常、以下のようにして `html` 要素に対するCSS定義で指定します。

```css
html{
    font-size: 10px;
}
```

ブラウザは標準ではルートのフォントサイズが16pxになっているケースがほとんどですが、
コーディングでpxの代わりにremを多用する場合、
サイト内で、`x rem` の値を計算するのを簡便にするために、ルートのフォントサイズを `10px` に設定するケースが多いようです。

またブラウザのフォントサイズをユーザが変更している場合等に考慮して、
直接10pxと指定するのではなく `font-size: 62.5%` として標準 `10px` を再現する場合もあります。

また、ルートに対するフォントサイズ指定であることを明記するために 
`html` の代わりに `:root` を用いることもできます。

```css
:root{
    font-size: 10px;
}
```

`:root`は、詳細度が高いことを除けば `html` と同等です。


https://developer.mozilla.org/ja/docs/Web/CSS/:root

### `vw` `vh`

`vw` `vh` は画面の高さ、幅に依存した単位として機能します。

100vwは画面幅と、 100vhは画面の高さと同等です。
概ねルートに対する `%` と同じような働きをしますが、
`vw` `vh` はブラウザのスクロールバーも含んだサイズとなる点が `%` と異なります。

`vw` を利用して画面幅に合わせて変化する正方形のCSS定義を行うことができます。

```css
.box{
    width: 20vw;
    height: 20vw;
}
```


